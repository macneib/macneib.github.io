<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Blair MacNeil's Blog]]></title><description><![CDATA[Thoughts on software, architecture, infrastructure and technology.]]></description><link>https://macneib.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Wed, 24 Feb 2021 08:57:14 GMT</lastBuildDate><item><title><![CDATA[Microk8s with Calico and Multus on a Raspberry pi cluster]]></title><description><![CDATA[Introduction This ultimately failed because multus for microk8s was disabled for ARM64 targets.
I will watch this issue and try again this…]]></description><link>https://macneib.github.io/02-microk8s-multus-raspberry-pi/</link><guid isPermaLink="false">https://macneib.github.io/02-microk8s-multus-raspberry-pi/</guid><pubDate>Wed, 24 Feb 2021 22:12:03 GMT</pubDate><content:encoded>&lt;h3&gt;Introduction&lt;/h3&gt;
&lt;p&gt;This ultimately failed because multus for microk8s was disabled for ARM64 targets.
I will watch &lt;a href=&quot;https://github.com/ubuntu/microk8s/pull/1872&quot;&gt;this issue&lt;/a&gt; and try again this PR has been accepted.&lt;/p&gt;
&lt;p&gt;Will try with k3sup as that has flannel-cni installed by default and people recomend that as a good starting place.&lt;/p&gt;
&lt;h3&gt;Step by step instructions&lt;/h3&gt;
&lt;p&gt;change the password in each pi board&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ssh ubuntu@192.168.1.16
exit

ssh ubuntu@192.168.1.17
exit

ssh ubuntu@192.168.1.18
exit

ssh ubuntu@192.168.1.19
exit&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Add nodes in dev machines &lt;code class=&quot;language-text&quot;&gt;/etc/hosts&lt;/code&gt; files&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;sudo vim /etc/hosts&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Paste the following snippet&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;192.168.1.16    master01 master01.microk8s
192.168.1.17    worker01 worker01.microk8s
192.168.1.18    worker02 worker02.microk8s
192.168.1.19    worker03 worker03.microk8s&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;install ansible on control machine&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;apt install ansible&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;sudo vim /etc/ansible/hosts&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Paste the following snippet&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;[masters]
master01  ansible_connection=ssh   var_hostname=master01 ansible_ssh_private_key_file=/home/macneib/.ssh/id_ed25519 ansible_ssh_user=ubuntu
#master02  ansible_connection=ssh   var_hostname=master02
#master03  ansible_connection=ssh   var_hostname=master03

[workers]
worker01  ansible_connection=ssh  var_hostname=worker01 ansible_ssh_private_key_file=/home/macneib/.ssh/id_ed25519 ansible_ssh_user=ubuntu
worker02  ansible_connection=ssh  var_hostname=worker02 ansible_ssh_private_key_file=/home/macneib/.ssh/id_ed25519 ansible_ssh_user=ubuntu
worker03  ansible_connection=ssh  var_hostname=worker03 ansible_ssh_private_key_file=/home/macneib/.ssh/id_ed25519 ansible_ssh_user=ubuntu
#worker04  ansible_connection=ssh  var_hostname=worker04
#worker05  ansible_connection=ssh  var_hostname=worker05
#worker06  ansible_connection=ssh  var_hostname=worker06

[microk8s:children]
masters
workers&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Generate an ssh key&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ssh-keygen -t ed25519 -C &amp;quot;your_email@example.com&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Copy ssh key over to remote machines&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ssh-copy-id -i ~/.ssh/id_ed25519.pub ubuntu@192.168.1.16
ssh-copy-id -i ~/.ssh/id_ed25519.pub ubuntu@192.168.1.17
ssh-copy-id -i ~/.ssh/id_ed25519.pub ubuntu@192.168.1.18
ssh-copy-id -i ~/.ssh/id_ed25519.pub ubuntu@192.168.1.19&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Check if Ansible is working fine and can connect to all nodes&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ansible microk8s -m ping&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ansible microk8s -b -m shell -a &amp;quot;hostnamectl set-hostname {{ var_hostname }}&amp;quot;
ansible cube -b -m shell -a &amp;quot;hostnamectl status | grep hostname&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Update the OS&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ansible microk8s -m apt -a &amp;quot;upgrade=yes update_cache=yes&amp;quot; --become&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Enable c-groups so the kubelet will work out of the box&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ansible microk8s -b -m shell -a &amp;quot;sed -i &amp;#39;$ s/$/ cgroup_enable=cpuset cgroup_enable=memory cgroup_memory=1 swapaccount=1/&amp;#39; /boot/firmware/cmdline.txt&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Quick restart to get all the machines updated&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ansible microk8s -b -m shell -a &amp;quot;shutdown -r now&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Install the MicroK8s snap and components&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ansible microk8s -b -m shell -a &amp;quot;sudo snap install microk8s --classic&amp;quot;
ansible microk8s -b -m shell -a &amp;quot;sudo microk8s.enable dns storage&amp;quot;
sudo reboot now&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Wait 1 minute then check status of masters&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ansible masters -b -m shell -a &amp;quot;sudo microk8s.kubectl get nodes&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Add workers to master&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ansible masters -b -m shell -a &amp;quot;sudo microk8s.add-node&amp;quot;
ansible worker01 -b -m shell -a &amp;quot;microk8s join 192.168.1.16:25000/&amp;lt;token&amp;gt;&amp;quot;

ansible masters -b -m shell -a &amp;quot;sudo microk8s.add-node&amp;quot;
ansible worker02 -b -m shell -a &amp;quot;microk8s join 192.168.1.16:25000/&amp;lt;token&amp;gt;&amp;quot;

ansible masters -b -m shell -a &amp;quot;sudo microk8s.add-node&amp;quot;
ansible worker03 -b -m shell -a &amp;quot;microk8s join 192.168.1.16:25000/&amp;lt;token&amp;gt;&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ansible masters -b -m shell -a &amp;quot;sudo microk8s enable multus&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;[WARNING]: Consider using &amp;#39;become&amp;#39;, &amp;#39;become_method&amp;#39;, and &amp;#39;become_user&amp;#39; rather than running sudo
master01 | FAILED | rc=1 &amp;gt;&amp;gt;
Nothing to do for `multus`.non-zero return code&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And this is the point where I realized that multus is not enabled on microk8s&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Apache Pulsar and ROS2]]></title><description><![CDATA[Introduction What is ROS 2 ROS means Robot Operating System (but it’s not an operating system) Features A Framework, Prescribed patterns and…]]></description><link>https://macneib.github.io/01-pulsar-and-ros2/</link><guid isPermaLink="false">https://macneib.github.io/01-pulsar-and-ros2/</guid><pubDate>Tue, 23 Feb 2021 22:12:03 GMT</pubDate><content:encoded>&lt;h3&gt;Introduction&lt;/h3&gt;
&lt;h3&gt;What is ROS 2&lt;/h3&gt;
&lt;p&gt;ROS means Robot Operating System (but it’s not an operating system)&lt;/p&gt;
&lt;h4&gt;Features&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;A Framework, Prescribed patterns and Software libraries, and Tools to build robots applications.&lt;/li&gt;
&lt;li&gt;A standard way to build and manage robot fleets.&lt;/li&gt;
&lt;li&gt;Real-time system capable.&lt;/li&gt;
&lt;li&gt;New capabilities for embedded platforms.&lt;/li&gt;
&lt;li&gt;A real-world approach to gracefully degrading networks.&lt;/li&gt;
&lt;li&gt;Python and C++ perferred, however bindings for Java, Rust and Node.js available.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;What is Apache Pulsar&lt;/h3&gt;
&lt;p&gt;Apache Pulsar is a cloud-native, distributed messaging and streaming platform.&lt;/p&gt;
&lt;h4&gt;Features&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Very low publish and end-to-end latency.&lt;/li&gt;
&lt;li&gt;Seamless scalability to over a million topics.&lt;/li&gt;
&lt;li&gt;A simple client API with bindings for Java, Go, Python and C++.&lt;/li&gt;
&lt;li&gt;Guaranteed message delivery with persistent message storage provided by Apache BookKeeper.&lt;/li&gt;
&lt;li&gt;A serverless light-weight computing framework Pulsar Functions offers the capability for stream-native data processing.&lt;/li&gt;
&lt;li&gt;Tiered Storage offloads data from hot/warm storage to cold/longterm storage (such as S3 and GCS) when the data is aging out.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Why not just use Kafka?&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://streamnative.io/en/blog/tech/2020-07-08-pulsar-vs-kafka-part-1&quot;&gt;Pulsar vs. Kafka — Part 1 — A More Accurate Perspective on Performance, Architecture, and Features&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Why do I want to connect these two?&lt;/h3&gt;
&lt;h3&gt;&lt;/h3&gt;
&lt;h3&gt;Next Steps&lt;/h3&gt;</content:encoded></item><item><title><![CDATA[Hello World]]></title><description><![CDATA[This is my first post on my new blog! How exciting!]]></description><link>https://macneib.github.io/hello-world/</link><guid isPermaLink="false">https://macneib.github.io/hello-world/</guid><pubDate>Mon, 01 Feb 2021 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;This is my first post on my new blog! How exciting!&lt;/p&gt;</content:encoded></item></channel></rss>